(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39c58b50"],{2837:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("CExtendedModal",{attrs:{vis:e.modalConfig.show,mData:e.modalConfig.data},on:{"modal-closed":function(t){return e.closeModalHandler()}},scopedSlots:e._u([{key:"role",fn:function(t){var o=t.item;return[a("CSelect",{attrs:{label:"Роль",options:e.roles,value:o.value},on:{"update:value":function(t){return e.$set(o,"value",t)}}})]}}])}),a("CDataTable",{attrs:{items:e.users,fields:e.fields,sorter:"",columnFilter:""},scopedSlots:e._u([{key:"role",fn:function(t){var o=t.item;return[a("td",[e._v(e._s(e.roles.find((function(e){return e.value===o.role})).label))])]}},{key:"createdAt",fn:function(t){var o=t.item;return[a("td",[e._v(e._s(new Date(o.createdAt).toLocaleString()))])]}},{key:"action",fn:function(t){var o=t.item;return[a("td",[a("CDropdown",{staticClass:"m-2",attrs:{"toggler-text":"Действия",color:"secondary"}},[a("CDropdownItem",{on:{click:function(t){return e.setRole(o)}}},[e._v("Изменить роль")]),e.isAdmin?a("CDropdownItem",{on:{click:function(t){return e.addLink(o)}}},[e._v("Добавить ссылку")]):e._e(),e.isAdmin?a("CDropdownItem",{on:{click:function(t){return e.addViolation(o)}}},[e._v("Добавить нарушение")]):e._e()],1)],1)]}}])})],1)},l=[],n=a("7a07"),i=a("d35b"),r={name:"Users",components:{CExtendedModal:n["a"]},mixins:[i["a"]],data:function(){return{modalConfig:{show:!1,data:{},cur:{}},roles:[{value:0,label:"Пользователь"},{value:1,label:"Администратор"},{value:2,label:"Арбитр"}],users:[],fields:[{key:"id",label:"Id"},{key:"role",label:"Роль"},{key:"chat_id",label:"Telegram Id"},{key:"username",label:"Имя пользователя"},{key:"first_name",label:"Имя"},{key:"locale",label:"Язык"},{key:"createdAt",label:"Дата регистрации"},{key:"action",label:"",filter:!1,sorter:!1}]}},mounted:function(){var e=this;this.$http({method:"GET",url:"/v1/user/"}).then((function(t){e.users=t.data}))},methods:{setRole:function(e){this.modalConfig.data={cur:e,fields:[{label:"role",value:e.role}],footer:"Сохранить",header:"Задать роль",type:"role"},this.modalConfig.show=!0},addViolation:function(e){this.modalConfig.data={cur:e,fields:[{label:"Комментарий",value:""}],footer:"Сохранить",header:"Добавить нарушение",type:"violation"},this.modalConfig.show=!0},addLink:function(e){this.modalConfig.data={cur:e,fields:[{label:"Ссылка на ресурс пользователя",value:""}],footer:"Сохранить",header:"Верифицировать пользователя",type:"link"},this.modalConfig.show=!0},closeModalHandler:function(){var e=this;if("role"==this.modalConfig.data.type){var t=this.modalConfig.data.fields.find((function(e){return"role"==e.label})).value;this.$http({method:"PUT",url:"/v1/user/".concat(this.modalConfig.data.cur.id,"/"),data:{role:t}}).then((function(a){e.modalConfig.data.cur.role=t}))}else if("link"==this.modalConfig.data.type){var a=this.modalConfig.data.cur.id,o=this.modalConfig.data.fields[0].value;this.$http({method:"POST",url:"/v1/link/",data:{userId:a,url:o}})}else if("violation"==this.modalConfig.data.type){var l=this.modalConfig.data.cur.id,n=this.modalConfig.data.fields[0].value;this.$http({method:"POST",url:"/v1/violation/",data:{userId:l,text:n}})}}}},d=r,s=a("2877"),u=Object(s["a"])(d,o,l,!1,null,null,null);t["default"]=u.exports},"7a07":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("CModal",{attrs:{show:e.vis,title:e.mData.header},on:{"update:show":function(t){e.vis=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[e.disableFooter?a("p"):a("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.closeModal()}}},[e._v(e._s(e.mData.footer))])]},proxy:!0}])},[e._t("content"),e._l(e.mData.fields,(function(t,o){return[e.$scopedSlots[t.label]?[e._t(t.label,null,{item:t})]:t.select?a("CSelect",{key:o,attrs:{label:t.label,value:t.value,options:t.select},on:{"update:value":function(a){return e.$set(t,"value",a)}}}):a("CInput",{key:o,attrs:{label:t.label},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}})]}))],2)},l=[],n={name:"ExtendedModal",data:function(){return{}},props:{vis:Boolean,disableFooter:Boolean,mData:Object},methods:{closeModal:function(){this.$emit("modal-closed"),this.vis=!1}}},i=n,r=a("2877"),d=Object(r["a"])(i,o,l,!1,null,null,null);t["a"]=d.exports}}]);
//# sourceMappingURL=chunk-39c58b50.615a579a.js.map