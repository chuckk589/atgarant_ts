{"version":3,"sources":["webpack:///./vue/views/Offers.vue?bd68","webpack:///vue/views/Offers.vue","webpack:///./vue/views/Offers.vue?ab61","webpack:///./vue/views/Offers.vue","webpack:///./vue/containers/CExtendedModal.vue?6c06","webpack:///vue/containers/CExtendedModal.vue","webpack:///./vue/containers/CExtendedModal.vue?0033","webpack:///./vue/containers/CExtendedModal.vue","webpack:///./vue/views/Offers.vue?e0ee"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","modalConfig","show","data","on","$event","closeModalHandler","scopedSlots","_u","key","fn","ref","item","value","label","$set","offers","fields","_v","_s","initiator","username","chat_id","offerStatus","name","partner","paymentMethod","Date","createdAt","toLocaleString","role","staticClass","isOwner","isSeller","nextStepAction","_e","setWallet","isPayable","receivePayout","isFeedbackable","leaveFeedback","openArbitrary","staticRenderFns","components","CExtendedModal","mixins","filter","sorter","mounted","$http","method","url","then","e","o","methods","cur","footer","header","type","seller","walletData","res","status","newWalletData","alert","reason","Object","offerId","authorId","recipientId","rate","text","sellerWalletData","userData","id","offer","component","vis","mData","closeModal","proxy","_t","_l","field","index","$scopedSlots","select","model","callback","$$v","expression","props","disableFooter","$emit"],"mappings":"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","file":"js/chunk-241ce14e.3442ccba.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('CExtendedModal',{attrs:{\"vis\":_vm.modalConfig.show,\"mData\":_vm.modalConfig.data},on:{\"modal-closed\":function($event){return _vm.closeModalHandler()}},scopedSlots:_vm._u([{key:\"type\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('CSelect',{attrs:{\"label\":\"Тип отзыва\",\"options\":[\n          { value: 'positive', label: 'Положительный' },\n          { value: 'negative', label: 'Отрицательный' } ],\"value\":item.value},on:{\"update:value\":function($event){return _vm.$set(item, \"value\", $event)}}})]}},{key:\"text\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('CTextarea',{attrs:{\"label\":\"Текст отзыва\",\"value\":item.value},on:{\"update:value\":function($event){return _vm.$set(item, \"value\", $event)}}})]}}])}),_c('CDataTable',{attrs:{\"items\":_vm.offers,\"fields\":_vm.fields,\"sorter\":\"\",\"columnFilter\":\"\"},scopedSlots:_vm._u([{key:\"initiator\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('td',{attrs:{\"data-label\":\"Инициатор сделки\"}},[_vm._v(\" \"+_vm._s(item.initiator.username || item.initiator.chat_id)+\" \")])]}},{key:\"offerStatus\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('td',{attrs:{\"data-label\":\"Статус сделки\"}},[_vm._v(\" \"+_vm._s(item.offerStatus.name)+\" \")])]}},{key:\"partner\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('td',{attrs:{\"data-label\":\"Компаньон\"}},[_vm._v(\" \"+_vm._s(item.partner.username || item.partner.chat_id)+\" \")])]}},{key:\"paymentMethod\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('td',{attrs:{\"data-label\":\"Способ оплаты\"}},[_vm._v(\" \"+_vm._s(item.paymentMethod.name)+\" \")])]}},{key:\"createdAt\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('td',{attrs:{\"data-label\":\"Дата создания\"}},[_vm._v(\" \"+_vm._s(new Date(item.createdAt).toLocaleString())+\" \")])]}},{key:\"role\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('td',{attrs:{\"data-label\":\"Роль инициатора\"}},[_vm._v(\" \"+_vm._s(item.role === \"seller\" ? \"Продавец\" : \"Покупатель\")+\" \")])]}},{key:\"action\",fn:function(ref){\n        var item = ref.item;\nreturn [_c('td',[_c('CDropdown',{staticClass:\"m-2\",attrs:{\"toggler-text\":\"Действия\",\"color\":\"secondary\"}},[(_vm.isOwner(item) && _vm.isSeller(item))?_c('CDropdownItem',{attrs:{\"disabled\":item.offerStatus.value !== 'payed'},on:{\"click\":function($event){return _vm.nextStepAction(item)}}},[_vm._v(\"Подтвердить отправку\")]):_vm._e(),(_vm.isOwner(item))?_c('CDropdownItem',{on:{\"click\":function($event){return _vm.setWallet(item)}}},[_vm._v(\"Указать кошелек\")]):_vm._e(),(_vm.isOwner(item) && _vm.isSeller(item))?_c('CDropdownItem',{attrs:{\"disabled\":_vm.isPayable(item)},on:{\"click\":function($event){return _vm.receivePayout(item)}}},[_vm._v(\"Получить выплату\")]):_vm._e(),(_vm.isOwner(item) && !_vm.isSeller(item))?_c('CDropdownItem',{attrs:{\"disabled\":item.offerStatus.value !== 'shipped'},on:{\"click\":function($event){return _vm.nextStepAction(item)}}},[_vm._v(\"Подтвердить получение\")]):_vm._e(),(_vm.isFeedbackable(item))?_c('CDropdownItem',{on:{\"click\":function($event){return _vm.leaveFeedback(item)}}},[_vm._v(\"Оставить отзыв\")]):_vm._e(),(_vm.isOwner(item))?_c('CDropdownItem',{attrs:{\"disabled\":item.offerStatus.value === 'closed' ||\n              item.offerStatus.value === 'arbitrary' ||\n              item.offerStatus.value === 'pending'},on:{\"click\":function($event){return _vm.openArbitrary(item)}}},[_vm._v(\"Арбитраж\")]):_vm._e()],1)],1)]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <CExtendedModal\r\n      @modal-closed=\"closeModalHandler()\"\r\n      :vis=\"modalConfig.show\"\r\n      :mData=\"modalConfig.data\"\r\n    >\r\n      <template #type=\"{ item }\">\r\n        <CSelect\r\n          label=\"Тип отзыва\"\r\n          :options=\"[\r\n            { value: 'positive', label: 'Положительный' },\r\n            { value: 'negative', label: 'Отрицательный' },\r\n          ]\"\r\n          :value.sync=\"item.value\"\r\n        />\r\n      </template>\r\n      <template #text=\"{ item }\">\r\n        <CTextarea label=\"Текст отзыва\" :value.sync=\"item.value\"></CTextarea>\r\n      </template>\r\n    </CExtendedModal>\r\n    <CDataTable :items=\"offers\" :fields=\"fields\" sorter columnFilter>\r\n      <template #initiator=\"{ item }\"\r\n        ><td data-label=\"Инициатор сделки\">\r\n          {{ item.initiator.username || item.initiator.chat_id }}\r\n        </td></template\r\n      >\r\n      <template #offerStatus=\"{ item }\"\r\n        ><td data-label=\"Статус сделки\">\r\n          {{ item.offerStatus.name }}\r\n        </td></template\r\n      >\r\n      <template #partner=\"{ item }\"\r\n        ><td data-label=\"Компаньон\">\r\n          {{ item.partner.username || item.partner.chat_id }}\r\n        </td></template\r\n      >\r\n      <template #paymentMethod=\"{ item }\"\r\n        ><td data-label=\"Способ оплаты\">\r\n          {{ item.paymentMethod.name }}\r\n        </td></template\r\n      >\r\n      <template #createdAt=\"{ item }\"\r\n        ><td data-label=\"Дата создания\">\r\n          {{ new Date(item.createdAt).toLocaleString() }}\r\n        </td></template\r\n      >\r\n      <template #role=\"{ item }\"\r\n        ><td data-label=\"Роль инициатора\">\r\n          {{ item.role === \"seller\" ? \"Продавец\" : \"Покупатель\" }}\r\n        </td></template\r\n      >\r\n      <template #action=\"{ item }\">\r\n        <td>\r\n          <CDropdown toggler-text=\"Действия\" class=\"m-2\" color=\"secondary\">\r\n            <CDropdownItem\r\n              @click=\"nextStepAction(item)\"\r\n              v-if=\"isOwner(item) && isSeller(item)\"\r\n              :disabled=\"item.offerStatus.value !== 'payed'\"\r\n              >Подтвердить отправку</CDropdownItem\r\n            >\r\n            <CDropdownItem @click=\"setWallet(item)\" v-if=\"isOwner(item)\"\r\n              >Указать кошелек</CDropdownItem\r\n            >\r\n            <CDropdownItem\r\n              @click=\"receivePayout(item)\"\r\n              v-if=\"isOwner(item) && isSeller(item)\"\r\n              :disabled=\"isPayable(item)\"\r\n              >Получить выплату</CDropdownItem\r\n            >\r\n            <CDropdownItem\r\n              @click=\"nextStepAction(item)\"\r\n              v-if=\"isOwner(item) && !isSeller(item)\"\r\n              :disabled=\"item.offerStatus.value !== 'shipped'\"\r\n              >Подтвердить получение</CDropdownItem\r\n            >\r\n            <CDropdownItem\r\n              @click=\"leaveFeedback(item)\"\r\n              v-if=\"isFeedbackable(item)\"\r\n              >Оставить отзыв</CDropdownItem\r\n            >\r\n            <!-- <CDropdownItem @click=\"nextStepAction(item)\" v-if=\"userData.id == item.initiator.id\">Повторно согласовать</CDropdownItem> -->\r\n            <CDropdownItem\r\n              @click=\"openArbitrary(item)\"\r\n              v-if=\"isOwner(item)\"\r\n              :disabled=\"\r\n                item.offerStatus.value === 'closed' ||\r\n                item.offerStatus.value === 'arbitrary' ||\r\n                item.offerStatus.value === 'pending'\r\n              \"\r\n              >Арбитраж</CDropdownItem\r\n            >\r\n          </CDropdown>\r\n        </td>\r\n      </template>\r\n    </CDataTable>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CExtendedModal from \"../containers/CExtendedModal.vue\";\r\nimport mixin from \"../mixins/userData\";\r\nexport default {\r\n  name: \"Offers\",\r\n  components: {\r\n    CExtendedModal,\r\n  },\r\n  mixins: [mixin],\r\n  data() {\r\n    return {\r\n      modalConfig: {\r\n        show: false,\r\n        data: {},\r\n      },\r\n      offers: [],\r\n      fields: [\r\n        { key: \"id\", label: \"Id\" },\r\n        { key: \"offerValue\", label: \"Сумма сделки\" },\r\n        { key: \"initiator\", label: \"Инициатор сделки\" },\r\n        { key: \"partner\", label: \"Компаньон\" },\r\n        { key: \"offerStatus\", label: \"Статус сделки\" },\r\n        { key: \"paymentMethod\", label: \"Способ оплаты\" },\r\n        { key: \"productAdditionalDetails\", label: \"Доп. детали\" },\r\n        { key: \"productDetails\", label: \"Детали\" },\r\n        { key: \"refundDetails\", label: \"Возврат\" },\r\n        { key: \"restDetails\", label: \"Остальное\" },\r\n        { key: \"role\", label: \"Роль инициатора\" },\r\n        { key: \"sellerWalletData\", label: \"Кошелек продавца\" },\r\n        { key: \"buyerWalletData\", label: \"Кошелек покупателя\" },\r\n        { key: \"shippingDetails\", label: \"Доставка\" },\r\n        { key: \"createdAt\", label: \"Дата создания\" },\r\n        { key: \"action\", label: \"\", filter: false, sorter: false },\r\n      ],\r\n    };\r\n  },\r\n  mounted: function () {\r\n    this.$http({\r\n      method: \"GET\",\r\n      url: `/v1/offer?userId=${\r\n        this.userData.role === 1 ? \"\" : this.userData.id\r\n      }`,\r\n    }).then((e) => {\r\n      this.offers =\r\n        this.userData.role === 1\r\n          ? e.data\r\n          : e.data.filter(\r\n              (o) =>\r\n                !(\r\n                  o.partner.id == this.userData.id &&\r\n                  o.offerStatus.value == \"pending\"\r\n                )\r\n            );\r\n    });\r\n  },\r\n  methods: {\r\n    leaveFeedback(item) {\r\n      this.modalConfig.data = {\r\n        cur: item,\r\n        fields: [\r\n          { label: \"text\", value: \"\" },\r\n          { label: \"type\", value: \"positive\" },\r\n        ],\r\n        footer: \"Сохранить\",\r\n        header: \"Редактировать\",\r\n        type: \"feedback\",\r\n      };\r\n      this.modalConfig.show = true;\r\n    },\r\n    setWallet(item) {\r\n      this.modalConfig.data = {\r\n        cur: item,\r\n        fields: [\r\n          {\r\n            label: \"Кошелек\",\r\n            value: this.isSeller(item)\r\n              ? item.sellerWalletData\r\n              : item.buyerWalletData,\r\n          },\r\n        ],\r\n        footer: \"Сохранить\",\r\n        header: \"Редактировать\",\r\n        type: \"wallet\",\r\n      };\r\n      this.modalConfig.show = true;\r\n    },\r\n    openArbitrary(item) {\r\n      this.modalConfig.data = {\r\n        cur: item,\r\n        fields: [{ label: \"Причина\", value: \"\" }],\r\n        footer: \"Отправить\",\r\n        header: \"Обращение в арбитраж\",\r\n        type: \"arbitrary\",\r\n      };\r\n      this.modalConfig.show = true;\r\n    },\r\n    closeModalHandler() {\r\n      if (this.modalConfig.data.type == \"wallet\") {\r\n        const newWalletData = this.modalConfig.data.fields.find(\r\n          (f) => f.label == \"Кошелек\"\r\n        ).value;\r\n        const isSeller = this.isSeller(this.modalConfig.data.cur);\r\n        this.$http({\r\n          method: \"PUT\",\r\n          url: `/v1/offer/${this.modalConfig.data.cur.id}/`,\r\n          data: { seller: isSeller, walletData: newWalletData },\r\n        }).then((res) => {\r\n          if (res.data.status !== \"error\") {\r\n            this.modalConfig.data.cur[\r\n              isSeller === true ? \"sellerWalletData\" : \"buyerWalletData\"\r\n            ] = newWalletData;\r\n          } else {\r\n            alert(\"Кошелек указан неверно\");\r\n          }\r\n        });\r\n      } else if (this.modalConfig.data.type == \"arbitrary\") {\r\n        const reason = this.modalConfig.data.fields.find(\r\n          (f) => f.label == \"Причина\"\r\n        ).value;\r\n        this.$http({\r\n          method: \"POST\",\r\n          url: `/v1/offer/${this.modalConfig.data.cur.id}/arbitrary/`,\r\n          data: {\r\n            reason: reason,\r\n            initiator: this.userData.id,\r\n          },\r\n        }).then((e) => {\r\n          Object.assign(\r\n            this.offers.find((o) => o.id === this.modalConfig.data.cur.id)\r\n              .offerStatus,\r\n            e.data.newStatus\r\n          );\r\n        });\r\n      } else if (this.modalConfig.data.type == \"feedback\") {\r\n        const type = this.modalConfig.data.fields.find(\r\n          (f) => f.label == \"type\"\r\n        ).value;\r\n        const text = this.modalConfig.data.fields.find(\r\n          (f) => f.label == \"text\"\r\n        ).value;\r\n        this.$http({\r\n          method: \"POST\",\r\n          url: `/v1/review/`,\r\n          data: {\r\n            offerId: this.modalConfig.data.cur.id,\r\n            authorId: this.userData.id,\r\n            recipientId:\r\n              this.modalConfig.data.cur.partnerId === this.userData.id\r\n                ? this.modalConfig.data.cur.initiatorId\r\n                : this.modalConfig.data.cur.partnerId,\r\n            rate: type,\r\n            text: text,\r\n          },\r\n        }).then(() => {\r\n          this.modalConfig.data.cur.reviews.push({\r\n            authorId: this.userData.id,\r\n          });\r\n        });\r\n      }\r\n    },\r\n    receivePayout(item) {\r\n      // data:{sellerWalletData:item.sellerWalletData }\r\n      this.$http({ method: \"POST\", url: `/v1/offer/${item.id}/action/` }).then(\r\n        (e) => {\r\n          if (e.status !== \"error\") {\r\n            Object.assign(\r\n              this.offers.find((o) => o.id === item.id).offerStatus,\r\n              e.data.newStatus\r\n            );\r\n          }\r\n        }\r\n      );\r\n    },\r\n    isPayable(item) {\r\n      return !(item.offerStatus.value === \"arrived\" && item.sellerWalletData);\r\n    },\r\n    isSeller(item) {\r\n      const seller =\r\n        item.role === \"seller\" ? item.initiator.id : item.partner.id;\r\n      return seller === this.userData.id;\r\n    },\r\n    isFeedbackable(item) {\r\n      return (\r\n        item.offerStatusId > 5 &&\r\n        !item.reviews.find((r) => r.authorId === this.userData.id)\r\n      );\r\n    },\r\n    isOwner(item) {\r\n      return (\r\n        this.userData.id === item.initiator.id ||\r\n        this.userData.id === item.partner.id\r\n      );\r\n    },\r\n    nextStepAction(offer) {\r\n      this.$http({ method: \"POST\", url: `/v1/offer/${offer.id}/action/` }).then(\r\n        (e) => {\r\n          if (e.status !== \"error\") {\r\n            offer.offerStatus = Object.assign({}, e.data.newStatus);\r\n          }\r\n        }\r\n      );\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style >\r\n@media screen and (max-width: 768px) {\r\n  table {\r\n    border: 0;\r\n  }\r\n\r\n  table thead {\r\n    display: none;\r\n  }\r\n\r\n  table tr {\r\n    margin-bottom: 10px;\r\n    display: block;\r\n    border: 1px solid #4f5d73;\r\n    border-radius: 2px;\r\n    /* border-bottom: 2px solid #ddd; */\r\n  }\r\n\r\n  table td {\r\n    display: block;\r\n    text-align: right;\r\n    font-size: 13px;\r\n    /* border-bottom: 1px dotted #ccc; */\r\n  }\r\n\r\n  table td:last-child {\r\n    border-bottom: 0;\r\n  }\r\n\r\n  table td:before {\r\n    content: attr(data-label);\r\n    float: left;\r\n    font-weight: bold;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Offers.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Offers.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Offers.vue?vue&type=template&id=0e526bb9&\"\nimport script from \"./Offers.vue?vue&type=script&lang=js&\"\nexport * from \"./Offers.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Offers.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CModal',{attrs:{\"show\":_vm.vis,\"title\":_vm.mData.header},on:{\"update:show\":function($event){_vm.vis=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [(_vm.disableFooter)?_c('p'):_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.closeModal()}}},[_vm._v(_vm._s(_vm.mData.footer))])]},proxy:true}])},[_vm._t(\"content\"),_vm._l((_vm.mData.fields),function(field,index){return [(_vm.$scopedSlots[field.label])?[_vm._t(field.label,null,{\"item\":field})]:(field.select)?_c('CSelect',{key:index,attrs:{\"label\":field.label,\"value\":field.value,\"options\":field.select},on:{\"update:value\":function($event){return _vm.$set(field, \"value\", $event)}}}):_c('CInput',{key:index,attrs:{\"label\":field.label},model:{value:(field.value),callback:function ($$v) {_vm.$set(field, \"value\", $$v)},expression:\"field.value\"}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <CModal :show.sync = \"vis\" :title =\"mData.header\">\r\n    <slot name = \"content\"></slot>\r\n    <template v-for=\"(field,index) in mData.fields\">\r\n      <template v-if=\"$scopedSlots[field.label]\">\r\n        <slot :name=\"field.label\" :item=\"field\" />\r\n      </template>\r\n      <CSelect v-else-if=\"field.select\" :label=\"field.label\" :value.sync=\"field.value\" :options=\"field.select\" :key=\"index\"/>\r\n      <CInput v-else :label=\"field.label\" v-model=\"field.value\" :key=\"index\"/>\r\n    </template>\r\n    <template #footer>\r\n      <p v-if=\"disableFooter\"></p>\r\n      <CButton v-else color=\"primary\" @click=\"closeModal()\">{{mData.footer}}</CButton>\r\n    </template>\r\n  </CModal>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'ExtendedModal',\r\n  \r\n  data () {\r\n    return {\r\n    }\r\n  },\r\n  props: {\r\n    vis: Boolean,\r\n    disableFooter:Boolean,\r\n    mData: Object\r\n    // {\r\n    //   fields:[{label:'22',value:22}],\r\n    //   footer:'test',\r\n    //   header:'testHeader'\r\n    // }\r\n  },\r\n  methods:{\r\n    closeModal(){\r\n      this.$emit('modal-closed')\r\n      this.vis = false\r\n    }\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CExtendedModal.vue?vue&type=template&id=fbe6e38a&\"\nimport script from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Offers.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}