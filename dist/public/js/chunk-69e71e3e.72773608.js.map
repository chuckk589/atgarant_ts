{"version":3,"sources":["webpack:///./vue/assets/scripts/telegram-web-app.js","webpack:///./vue/views/WebApp.vue?ae60","webpack:///vue/views/WebApp.vue","webpack:///./vue/views/WebApp.vue?4c3d","webpack:///./vue/views/WebApp.vue","webpack:///./vue/views/WebApp.vue?98e8"],"names":["eventHandlers","locationHash","location","hash","toString","e","iFrameStyle","initParams","urlParseHashParams","isIframe","window","parent","addEventListener","event","source","dataParsed","JSON","parse","data","eventType","innerHTML","eventData","receiveEvent","document","createElement","head","appendChild","postMessage","stringify","urlSafeDecode","urlencoded","replace","decodeURIComponent","params","length","indexOf","_path","qIndex","pathParam","substr","query_params","urlParseQueryString","k","queryString","i","param","paramName","paramValue","queryStringParams","split","urlAppendHashParams","url","addHash","ind","curHash","postEvent","callback","undefined","TelegramWebviewProxy","external","notify","trustedTarget","tgWebAppDebug","console","log","notAvailable","callEventCallbacks","func","curEventHandlers","onEvent","index","push","offEvent","splice","Telegram","WebView","Utils","TelegramGameProxy_receiveEvent","TelegramGameProxy","WebApp","webAppInitData","webAppInitDataUnsafe","themeParams","colorScheme","webAppVersion","tgWebAppData","key","val","tgWebAppThemeParams","themeParamsRaw","theme_params","setThemeParams","onThemeChanged","MainButton","setParams","force_update","receiveWebViewEvent","tgWebAppVersion","lastWindowHeight","innerHeight","onViewportChanged","height","removeEventListener","onWindowResize","setViewportHeight","isStateStable","linkHandler","metaKey","ctrlKey","el","target","tagName","parentNode","protocol","hostname","openTgLink","href","preventDefault","args","Array","prototype","slice","call","arguments","shift","apply","onWebViewEvent","offWebViewEvent","setCssProperty","name","value","root","documentElement","style","setProperty","color","parseColorToHex","isColorDark","join","viewportHeight","viewportStableHeight","isExpanded","stable_height","is_expanded","is_state_stable","mainButtonHeight","match","test","toLowerCase","exec","rgb","r","parseInt","g","b","hsp","Math","sqrt","versionCompare","v1","v2","p1","p2","a","max","versionAtLeast","ver","byteLength","str","Blob","size","s","code","charCodeAt","isVisible","isActive","isProgressVisible","buttonText","buttonColor","buttonTextColor","mainButton","Object","defineProperty","set","text","get","enumerable","button_color","text_color","button_text_color","is_visible","is_active","curButtonState","onMainButtonPressed","debugBtn","debugBtnStyle","font","display","width","borderRadius","background","position","left","right","bottom","margin","padding","textAlign","boxSizing","zIndex","onDomLoaded","body","buttonParams","textColor","is_progress_visible","buttonState","btn_params","updateButton","btn_state","updateDebugButton","opacity","cursor","disabled","innerText","backgroundImage","backgroundColor","paddingBottom","error","Error","setText","onClick","offClick","show","hide","enable","disable","showProgress","leaveActive","hideProgress","webAppInvoices","onInvoiceClosed","slug","invoiceData","status","isVersionAtLeast","sendData","openTelegramLink","path_full","pathname","search","openInvoice","ready","expand","close","render","_vm","this","_h","$createElement","_c","_self","_v","staticClass","attrs","partnerVariants","renderSuggestion","getSuggestionValue","class","id","placeholder","on","onSelected","fetchResults","feePayer","label","$event","paymentMethodId","paymentMethods","staticStyle","_s","pmString","model","$$v","offerValue","expression","feeString","_e","estimatedShipping","refundDetails","productDetails","shippingDetails","productAdditionalDetails","restDetails","nativeOn","drop","staticRenderFns","query","partnerId","created","method","mounted","methods","suggestion","getPmCode","pm","computed","component"],"mappings":"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","file":"js/chunk-69e71e3e.72773608.js","sourcesContent":["// WebView\r\n(function () {\r\n    var eventHandlers = {};\r\n  \r\n    var locationHash = '';\r\n    try {\r\n      locationHash = location.hash.toString();\r\n    } catch (e) {}\r\n  \r\n    var initParams = urlParseHashParams(locationHash);\r\n  \r\n    var isIframe = false, iFrameStyle;\r\n    try {\r\n      isIframe = (window.parent != null && window != window.parent);\r\n      if (isIframe) {\r\n        window.addEventListener('message', function (event) {\r\n          if (event.source !== window.parent) return;\r\n          try {\r\n            var dataParsed = JSON.parse(event.data);\r\n          } catch (e) {\r\n            return;\r\n          }\r\n          if (!dataParsed || !dataParsed.eventType) {\r\n            return;\r\n          }\r\n          if (dataParsed.eventType == 'set_custom_style') {\r\n            iFrameStyle.innerHTML = dataParsed.eventData;\r\n          } else {\r\n            receiveEvent(dataParsed.eventType, dataParsed.eventData);\r\n          }\r\n        });\r\n        iFrameStyle = document.createElement('style');\r\n        document.head.appendChild(iFrameStyle);\r\n        try {\r\n          window.parent.postMessage(JSON.stringify({eventType: 'iframe_ready'}), '*');\r\n        } catch (e) {}\r\n      }\r\n    } catch (e) {}\r\n  \r\n    function urlSafeDecode(urlencoded) {\r\n      try {\r\n        urlencoded = urlencoded.replace(/\\+/g, '%20');\r\n        return decodeURIComponent(urlencoded);\r\n      } catch (e) {\r\n        return urlencoded;\r\n      }\r\n    }\r\n  \r\n    function urlParseHashParams(locationHash) {\r\n      locationHash = locationHash.replace(/^#/, '');\r\n      var params = {};\r\n      if (!locationHash.length) {\r\n        return params;\r\n      }\r\n      if (locationHash.indexOf('=') < 0 && locationHash.indexOf('?') < 0) {\r\n        params._path = urlSafeDecode(locationHash);\r\n        return params;\r\n      }\r\n      var qIndex = locationHash.indexOf('?');\r\n      if (qIndex >= 0) {\r\n        var pathParam = locationHash.substr(0, qIndex);\r\n        params._path = urlSafeDecode(pathParam);\r\n        locationHash = locationHash.substr(qIndex + 1);\r\n      }\r\n      var query_params = urlParseQueryString(locationHash);\r\n      for (var k in query_params) {\r\n        params[k] = query_params[k];\r\n      }\r\n      return params;\r\n    }\r\n  \r\n    function urlParseQueryString(queryString) {\r\n      var params = {};\r\n      if (!queryString.length) {\r\n        return params;\r\n      }\r\n      var queryStringParams = queryString.split('&');\r\n      var i, param, paramName, paramValue;\r\n      for (i = 0; i < queryStringParams.length; i++) {\r\n        param = queryStringParams[i].split('=');\r\n        paramName = urlSafeDecode(param[0]);\r\n        paramValue = param[1] == null ? null : urlSafeDecode(param[1]);\r\n        params[paramName] = paramValue;\r\n      }\r\n      return params;\r\n    }\r\n  \r\n    // Telegram apps will implement this logic to add service params (e.g. tgShareScoreUrl) to game URL\r\n    function urlAppendHashParams(url, addHash) {\r\n      // url looks like 'https://game.com/path?query=1#hash'\r\n      // addHash looks like 'tgShareScoreUrl=' + encodeURIComponent('tgb://share_game_score?hash=very_long_hash123')\r\n  \r\n      var ind = url.indexOf('#');\r\n      if (ind < 0) {\r\n        // https://game.com/path -> https://game.com/path#tgShareScoreUrl=etc\r\n        return url + '#' + addHash;\r\n      }\r\n      var curHash = url.substr(ind + 1);\r\n      if (curHash.indexOf('=') >= 0 || curHash.indexOf('?') >= 0) {\r\n        // https://game.com/#hash=1 -> https://game.com/#hash=1&tgShareScoreUrl=etc\r\n        // https://game.com/#path?query -> https://game.com/#path?query&tgShareScoreUrl=etc\r\n        return url + '&' + addHash;\r\n      }\r\n      // https://game.com/#hash -> https://game.com/#hash?tgShareScoreUrl=etc\r\n      if (curHash.length > 0) {\r\n        return url + '?' + addHash;\r\n      }\r\n      // https://game.com/# -> https://game.com/#tgShareScoreUrl=etc\r\n      return url + addHash;\r\n    }\r\n  \r\n    function postEvent(eventType, callback, eventData) {\r\n      if (!callback) {\r\n        callback = function () {};\r\n      }\r\n      if (eventData === undefined) {\r\n        eventData = '';\r\n      }\r\n  \r\n      if (window.TelegramWebviewProxy !== undefined) {\r\n        TelegramWebviewProxy.postEvent(eventType, JSON.stringify(eventData));\r\n        callback();\r\n      }\r\n      else if (window.external && 'notify' in window.external) {\r\n        window.external.notify(JSON.stringify({eventType: eventType, eventData: eventData}));\r\n        callback();\r\n      }\r\n      else if (isIframe) {\r\n        try {\r\n          var trustedTarget = 'https://web.telegram.org';\r\n          // For now we don't restrict target, for testing purposes\r\n          trustedTarget = '*';\r\n          window.parent.postMessage(JSON.stringify({eventType: eventType, eventData: eventData}), trustedTarget);\r\n          if (initParams.tgWebAppDebug) {\r\n            console.log('[Telegram.WebView] postEvent via postMessage', eventType, eventData);\r\n          }\r\n          callback();\r\n        } catch (e) {\r\n          callback(e);\r\n        }\r\n      }\r\n      else {\r\n        if (initParams.tgWebAppDebug) {\r\n          console.log('[Telegram.WebView] postEvent', eventType, eventData);\r\n        }\r\n        callback({notAvailable: true});\r\n      }\r\n    };\r\n  \r\n    function receiveEvent(eventType, eventData) {\r\n      callEventCallbacks(eventType, function(callback) {\r\n        callback(eventType, eventData);\r\n      });\r\n    }\r\n  \r\n    function callEventCallbacks(eventType, func) {\r\n      var curEventHandlers = eventHandlers[eventType];\r\n      if (curEventHandlers === undefined ||\r\n          !curEventHandlers.length) {\r\n        return;\r\n      }\r\n      for (var i = 0; i < curEventHandlers.length; i++) {\r\n        try {\r\n          func(curEventHandlers[i]);\r\n        } catch (e) {}\r\n      }\r\n    }\r\n  \r\n    function onEvent(eventType, callback) {\r\n      if (eventHandlers[eventType] === undefined) {\r\n        eventHandlers[eventType] = [];\r\n      }\r\n      var index = eventHandlers[eventType].indexOf(callback);\r\n      if (index === -1) {\r\n        eventHandlers[eventType].push(callback);\r\n      }\r\n    };\r\n  \r\n    function offEvent(eventType, callback) {\r\n      if (eventHandlers[eventType] === undefined) {\r\n        return;\r\n      }\r\n      var index = eventHandlers[eventType].indexOf(callback);\r\n      if (index === -1) {\r\n        return;\r\n      }\r\n      eventHandlers[eventType].splice(index, 1);\r\n    };\r\n  \r\n    function openProtoUrl(url) {\r\n      if (!url.match(/^(web\\+)?tgb?:\\/\\/./)) {\r\n        return false;\r\n      }\r\n      var useIframe = navigator.userAgent.match(/iOS|iPhone OS|iPhone|iPod|iPad/i) ? true : false;\r\n      if (useIframe) {\r\n        var iframeContEl = document.getElementById('tgme_frame_cont') || document.body;\r\n        var iframeEl = document.createElement('iframe');\r\n        iframeContEl.appendChild(iframeEl);\r\n        var pageHidden = false;\r\n        var enableHidden = function () {\r\n          pageHidden = true;\r\n        };\r\n        window.addEventListener('pagehide', enableHidden, false);\r\n        window.addEventListener('blur', enableHidden, false);\r\n        if (iframeEl !== null) {\r\n          iframeEl.src = url;\r\n        }\r\n        setTimeout(function() {\r\n          if (!pageHidden) {\r\n            window.location = url;\r\n          }\r\n          window.removeEventListener('pagehide', enableHidden, false);\r\n          window.removeEventListener('blur', enableHidden, false);\r\n        }, 2000);\r\n      }\r\n      else {\r\n        window.location = url;\r\n      }\r\n      return true;\r\n    }\r\n  \r\n    if (!window.Telegram) {\r\n      window.Telegram = {};\r\n    }\r\n    window.Telegram.WebView = {\r\n      initParams: initParams,\r\n      isIframe: isIframe,\r\n      onEvent: onEvent,\r\n      offEvent: offEvent,\r\n      postEvent: postEvent,\r\n      receiveEvent: receiveEvent,\r\n      callEventCallbacks: callEventCallbacks\r\n    };\r\n  \r\n    window.Telegram.Utils = {\r\n      urlSafeDecode: urlSafeDecode,\r\n      urlParseQueryString: urlParseQueryString,\r\n      urlParseHashParams: urlParseHashParams,\r\n      urlAppendHashParams: urlAppendHashParams\r\n    };\r\n  \r\n    // For Windows Phone app\r\n    window.TelegramGameProxy_receiveEvent = receiveEvent;\r\n  \r\n    // App backward compatibility\r\n    window.TelegramGameProxy = {\r\n      receiveEvent: receiveEvent\r\n    };\r\n  })();\r\n  \r\n  // WebApp\r\n  (function () {\r\n    var Utils = window.Telegram.Utils;\r\n    var WebView = window.Telegram.WebView;\r\n    var initParams = WebView.initParams;\r\n    var isIframe = WebView.isIframe;\r\n  \r\n    var WebApp = {};\r\n    var webAppInitData = '', webAppInitDataUnsafe = {};\r\n    var themeParams = {}, colorScheme = 'light';\r\n    var webAppVersion = '6.0';\r\n  \r\n    if (initParams.tgWebAppData && initParams.tgWebAppData.length) {\r\n      webAppInitData = initParams.tgWebAppData;\r\n      webAppInitDataUnsafe = Utils.urlParseQueryString(webAppInitData);\r\n      for (var key in webAppInitDataUnsafe) {\r\n        var val = webAppInitDataUnsafe[key];\r\n        try {\r\n          if (val.substr(0, 1) == '{' && val.substr(-1) == '}' ||\r\n              val.substr(0, 1) == '[' && val.substr(-1) == ']') {\r\n            webAppInitDataUnsafe[key] = JSON.parse(val);\r\n          }\r\n        } catch (e) {}\r\n      }\r\n    }\r\n    if (initParams.tgWebAppThemeParams && initParams.tgWebAppThemeParams.length) {\r\n      var themeParamsRaw = initParams.tgWebAppThemeParams;\r\n      try {\r\n        var theme_params = JSON.parse(themeParamsRaw);\r\n        setThemeParams(theme_params);\r\n      } catch (e) {}\r\n    }\r\n    if (initParams.tgWebAppVersion) {\r\n      webAppVersion = initParams.tgWebAppVersion;\r\n    }\r\n  \r\n    function onThemeChanged(eventType, eventData) {\r\n      if (eventData.theme_params) {\r\n        setThemeParams(eventData.theme_params);\r\n        window.Telegram.WebApp.MainButton.setParams({\r\n          force_update: true\r\n        });\r\n        receiveWebViewEvent('themeChanged');\r\n      }\r\n    }\r\n  \r\n    var lastWindowHeight = window.innerHeight;\r\n    function onViewportChanged(eventType, eventData) {\r\n      if (eventData.height) {\r\n        window.removeEventListener('resize', onWindowResize);\r\n        setViewportHeight(eventData);\r\n      }\r\n    }\r\n  \r\n    function onWindowResize(e) {\r\n      if (lastWindowHeight != window.innerHeight) {\r\n        lastWindowHeight = window.innerHeight;\r\n        receiveWebViewEvent('viewportChanged', {\r\n          isStateStable: true\r\n        });\r\n      }\r\n    }\r\n  \r\n    function linkHandler(e) {\r\n      if (e.metaKey || e.ctrlKey) return;\r\n      var el = e.target;\r\n      while (el.tagName != 'A' && el.parentNode) {\r\n        el = el.parentNode;\r\n      }\r\n      if (el.tagName == 'A' &&\r\n          el.target != '_blank' &&\r\n          (el.protocol == 'http:' || el.protocol == 'https:') &&\r\n          el.hostname == 't.me') {\r\n        WebApp.openTgLink(el.href);\r\n        e.preventDefault();\r\n      }\r\n    }\r\n  \r\n    function receiveWebViewEvent(eventType) {\r\n      var args = Array.prototype.slice.call(arguments);\r\n      eventType = args.shift();\r\n      WebView.callEventCallbacks('webview:' + eventType, function(callback) {\r\n        callback.apply(WebApp, args);\r\n      });\r\n    }\r\n  \r\n    function onWebViewEvent(eventType, callback) {\r\n      WebView.onEvent('webview:' + eventType, callback);\r\n    };\r\n  \r\n    function offWebViewEvent(eventType, callback) {\r\n      WebView.offEvent('webview:' + eventType, callback);\r\n    };\r\n  \r\n    function setCssProperty(name, value) {\r\n      var root = document.documentElement;\r\n      if (root && root.style && root.style.setProperty) {\r\n        root.style.setProperty('--tg-' + name, value);\r\n      }\r\n    }\r\n  \r\n    function setThemeParams(theme_params) {\r\n      var color;\r\n      for (var key in theme_params) {\r\n        if (color = parseColorToHex(theme_params[key])) {\r\n          themeParams[key] = color;\r\n          if (key == 'bg_color') {\r\n            colorScheme = isColorDark(color) ? 'dark' : 'light'\r\n            setCssProperty('color-scheme', colorScheme);\r\n          }\r\n          key = 'theme-' + key.split('_').join('-');\r\n          setCssProperty(key, color);\r\n        }\r\n      }\r\n    }\r\n  \r\n    var viewportHeight = false, viewportStableHeight = false, isExpanded = true;\r\n    function setViewportHeight(data) {\r\n      if (typeof data !== 'undefined') {\r\n        isExpanded = !!data.is_expanded;\r\n        viewportHeight = data.height;\r\n        if (data.is_state_stable) {\r\n          viewportStableHeight = data.height;\r\n        }\r\n        receiveWebViewEvent('viewportChanged', {\r\n          isStateStable: !!data.is_state_stable\r\n        });\r\n      }\r\n      var height, stable_height;\r\n      if (viewportHeight !== false) {\r\n        height = (viewportHeight - mainButtonHeight) + 'px';\r\n      } else {\r\n        height = mainButtonHeight ? 'calc(100vh - ' + mainButtonHeight + 'px)' : '100vh';\r\n      }\r\n      if (viewportStableHeight !== false) {\r\n        stable_height = (viewportStableHeight - mainButtonHeight) + 'px';\r\n      } else {\r\n        stable_height = mainButtonHeight ? 'calc(100vh - ' + mainButtonHeight + 'px)' : '100vh';\r\n      }\r\n      setCssProperty('viewport-height', height);\r\n      setCssProperty('viewport-stable-height', stable_height);\r\n    }\r\n  \r\n  \r\n    function parseColorToHex(color) {\r\n      color += '';\r\n      var match;\r\n      if (/^#([0-9a-f]){6}$/i.test(color)) {\r\n        return color.toLowerCase();\r\n      }\r\n      else if (match = /^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(color)) {\r\n        return ('#' + match[1] + match[1] + match[2] + match[2] + match[3] + match[3]).toLowerCase();\r\n      }\r\n      return false;\r\n    }\r\n  \r\n    function isColorDark(rgb) {\r\n      rgb = rgb.replace(/[\\s#]/g, '');\r\n      if (rgb.length == 3) {\r\n        rgb = rgb[0] + rgb[0] + rgb[1] + rgb[1] + rgb[2] + rgb[2];\r\n      }\r\n      var r = parseInt(rgb.substr(0, 2), 16);\r\n      var g = parseInt(rgb.substr(2, 2), 16);\r\n      var b = parseInt(rgb.substr(4, 2), 16);\r\n      var hsp = Math.sqrt(0.299 * (r * r) + 0.587 * (g * g) + 0.114 * (b * b));\r\n      return hsp < 120;\r\n    }\r\n  \r\n    function versionCompare(v1, v2) {\r\n      if (typeof v1 !== 'string') v1 = '';\r\n      if (typeof v2 !== 'string') v2 = '';\r\n      v1 = v1.replace(/^\\s+|\\s+$/g, '').split('.');\r\n      v2 = v2.replace(/^\\s+|\\s+$/g, '').split('.');\r\n      var a = Math.max(v1.length, v2.length), i, p1, p2;\r\n      for (i = 0; i < a; i++) {\r\n        p1 = parseInt(v1[i]) || 0;\r\n        p2 = parseInt(v2[i]) || 0;\r\n        if (p1 == p2) continue;\r\n        if (p1 > p2) return 1;\r\n        return -1;\r\n      }\r\n      return 0;\r\n    }\r\n  \r\n    function versionAtLeast(ver) {\r\n      return versionCompare(webAppVersion, ver) >= 0;\r\n    }\r\n  \r\n    function byteLength(str) {\r\n      if (window.Blob) {\r\n        try { return new Blob([str]).size; } catch (e) {}\r\n      }\r\n      var s = str.length;\r\n      for (var i=str.length-1; i>=0; i--) {\r\n        var code = str.charCodeAt(i);\r\n        if (code > 0x7f && code <= 0x7ff) s++;\r\n        else if (code > 0x7ff && code <= 0xffff) s+=2;\r\n        if (code >= 0xdc00 && code <= 0xdfff) i--;\r\n      }\r\n      return s;\r\n    }\r\n  \r\n    var mainButtonHeight = 0;\r\n    var MainButton = (function() {\r\n      var isVisible = false;\r\n      var isActive = true;\r\n      var isProgressVisible = false;\r\n      var buttonText = 'CONTINUE';\r\n      var buttonColor = false;\r\n      var buttonTextColor = false;\r\n  \r\n      var mainButton = {};\r\n      Object.defineProperty(mainButton, 'text', {\r\n        set: function(val){ mainButton.setParams({text: val}); },\r\n        get: function(){ return buttonText; },\r\n        enumerable: true\r\n      });\r\n      Object.defineProperty(mainButton, 'color', {\r\n        set: function(val){ mainButton.setParams({color: val}); },\r\n        get: function(){ return buttonColor || themeParams.button_color || '#2481cc'; },\r\n        enumerable: true\r\n      });\r\n      Object.defineProperty(mainButton, 'textColor', {\r\n        set: function(val){ mainButton.setParams({text_color: val}); },\r\n        get: function(){ return buttonTextColor || themeParams.button_text_color || '#ffffff'; },\r\n        enumerable: true\r\n      });\r\n      Object.defineProperty(mainButton, 'isVisible', {\r\n        set: function(val){ mainButton.setParams({is_visible: val}); },\r\n        get: function(){ return isVisible; },\r\n        enumerable: true\r\n      });\r\n      Object.defineProperty(mainButton, 'isProgressVisible', {\r\n        get: function(){ return isProgressVisible; },\r\n        enumerable: true\r\n      });\r\n      Object.defineProperty(mainButton, 'isActive', {\r\n        set: function(val){ mainButton.setParams({is_active: val}); },\r\n        get: function(){ return isActive; },\r\n        enumerable: true\r\n      });\r\n  \r\n      var curButtonState = null;\r\n  \r\n      WebView.onEvent('main_button_pressed', onMainButtonPressed);\r\n  \r\n      var debugBtn = null, debugBtnStyle = {};\r\n      if (initParams.tgWebAppDebug) {\r\n        debugBtn = document.createElement('tg-main-button');\r\n        debugBtnStyle = {\r\n          font: '600 14px/18px sans-serif',\r\n          display: 'none',\r\n          width: '100%',\r\n          height: '48px',\r\n          borderRadius: '0',\r\n          background: 'no-repeat right center',\r\n          position: 'fixed',\r\n          left: '0',\r\n          right: '0',\r\n          bottom: '0',\r\n          margin: '0',\r\n          padding: '15px 20px',\r\n          textAlign: 'center',\r\n          boxSizing: 'border-box',\r\n          zIndex: '10000'\r\n        };\r\n        for (var k in debugBtnStyle) {\r\n          debugBtn.style[k] = debugBtnStyle[k];\r\n        }\r\n        document.addEventListener('DOMContentLoaded', function onDomLoaded(event) {\r\n          document.removeEventListener('DOMContentLoaded', onDomLoaded);\r\n          document.body.appendChild(debugBtn);\r\n          debugBtn.addEventListener('click', onMainButtonPressed, false);\r\n        });\r\n      }\r\n  \r\n      function onMainButtonPressed() {\r\n        if (isActive) {\r\n          receiveWebViewEvent('mainButtonClicked');\r\n        }\r\n      }\r\n  \r\n      function buttonParams() {\r\n        var color = mainButton.color;\r\n        var text_color = mainButton.textColor;\r\n        return isVisible ? {\r\n          is_visible: true,\r\n          is_active: isActive,\r\n          is_progress_visible: isProgressVisible,\r\n          text: buttonText,\r\n          color: color,\r\n          text_color: text_color\r\n        } : {is_visible: false};\r\n      }\r\n  \r\n      function buttonState(btn_params) {\r\n        if (typeof btn_params === 'undefined') {\r\n          btn_params = buttonParams();\r\n        }\r\n        return JSON.stringify(btn_params);\r\n      }\r\n  \r\n      function updateButton() {\r\n        var btn_params = buttonParams();\r\n        var btn_state = buttonState(btn_params);\r\n        if (curButtonState === btn_state) {\r\n          return;\r\n        }\r\n        curButtonState = btn_state;\r\n        WebView.postEvent('web_app_setup_main_button', false, btn_params);\r\n        if (initParams.tgWebAppDebug) {\r\n          updateDebugButton(btn_params);\r\n        }\r\n      }\r\n  \r\n      function updateDebugButton(btn_params) {\r\n        if (btn_params.is_visible) {\r\n          debugBtn.style.display = 'block';\r\n          mainButtonHeight = 48;\r\n  \r\n          debugBtn.style.opacity = btn_params.is_active ? '1' : '0.8';\r\n          debugBtn.style.cursor = btn_params.is_active ? 'pointer' : 'auto';\r\n          debugBtn.disabled = !btn_params.is_active;\r\n          debugBtn.innerText = btn_params.text;\r\n          debugBtn.style.backgroundImage = btn_params.is_progress_visible ? \"url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20viewport%3D%220%200%2048%2048%22%20width%3D%2248px%22%20height%3D%2248px%22%3E%3Ccircle%20cx%3D%2250%25%22%20cy%3D%2250%25%22%20stroke%3D%22%23fff%22%20stroke-width%3D%222.25%22%20stroke-linecap%3D%22round%22%20fill%3D%22none%22%20stroke-dashoffset%3D%22106%22%20r%3D%229%22%20stroke-dasharray%3D%2256.52%22%20rotate%3D%22-90%22%3E%3Canimate%20attributeName%3D%22stroke-dashoffset%22%20attributeType%3D%22XML%22%20dur%3D%22360s%22%20from%3D%220%22%20to%3D%2212500%22%20repeatCount%3D%22indefinite%22%3E%3C%2Fanimate%3E%3CanimateTransform%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22rotate%22%20dur%3D%221s%22%20from%3D%22-90%2024%2024%22%20to%3D%22630%2024%2024%22%20repeatCount%3D%22indefinite%22%3E%3C%2FanimateTransform%3E%3C%2Fcircle%3E%3C%2Fsvg%3E')\" : 'none';\r\n          debugBtn.style.backgroundColor = btn_params.color;\r\n          debugBtn.style.color = btn_params.text_color;\r\n        } else {\r\n          debugBtn.style.display = 'none';\r\n          mainButtonHeight = 0;\r\n        }\r\n        if (document.documentElement) {\r\n          document.documentElement.style.boxSizing = 'border-box';\r\n          document.documentElement.style.paddingBottom = mainButtonHeight + 'px';\r\n        }\r\n        setViewportHeight();\r\n      }\r\n  \r\n      function setParams(params) {\r\n        if (typeof params.text !== 'undefined') {\r\n          var text = params.text.toString().replace(/^\\s+|\\s+$/g, '');\r\n          if (!text.length) {\r\n            console.error('[Telegram.WebApp] Main button text is required', params.text);\r\n            throw Error('WebAppMainButtonParamInvalid');\r\n          }\r\n          if (text.length > 64) {\r\n            console.error('[Telegram.WebApp] Main button text is too long', text);\r\n            throw Error('WebAppMainButtonParamInvalid');\r\n          }\r\n          buttonText = text;\r\n        }\r\n        if (typeof params.color !== 'undefined') {\r\n          if (params.color === false ||\r\n              params.color === null) {\r\n            buttonColor = false;\r\n          } else {\r\n            var color = parseColorToHex(params.color);\r\n            if (!color) {\r\n              console.error('[Telegram.WebApp] Main button color format is invalid', color);\r\n              throw Error('WebAppMainButtonParamInvalid');\r\n            }\r\n            buttonColor = color;\r\n          }\r\n        }\r\n        if (typeof params.text_color !== 'undefined') {\r\n          if (params.text_color === false ||\r\n              params.text_color === null) {\r\n            buttonTextColor = false;\r\n          } else {\r\n            var text_color = parseColorToHex(params.text_color);\r\n            if (!text_color) {\r\n              console.error('[Telegram.WebApp] Main button text color format is invalid', text_color);\r\n              throw Error('WebAppMainButtonParamInvalid');\r\n            }\r\n            buttonTextColor = text_color;\r\n          }\r\n        }\r\n        if (typeof params.is_visible !== 'undefined') {\r\n          if (params.is_visible &&\r\n              !mainButton.text.length) {\r\n            console.error('[Telegram.WebApp] Main button text is required');\r\n            throw Error('WebAppMainButtonParamInvalid');\r\n          }\r\n          isVisible = !!params.is_visible;\r\n        }\r\n        if (typeof params.is_active !== 'undefined') {\r\n          isActive = !!params.is_active;\r\n        }\r\n        updateButton();\r\n        return mainButton;\r\n      }\r\n  \r\n      mainButton.setText = function(text) {\r\n        return mainButton.setParams({text: text});\r\n      };\r\n      mainButton.onClick = function(callback) {\r\n        onWebViewEvent('mainButtonClicked', callback);\r\n        return mainButton;\r\n      };\r\n      mainButton.offClick = function(callback) {\r\n        offWebViewEvent('mainButtonClicked', callback);\r\n        return mainButton;\r\n      };\r\n      mainButton.show = function() {\r\n        return mainButton.setParams({is_visible: true});\r\n      };\r\n      mainButton.hide = function() {\r\n        return mainButton.setParams({is_visible: false});\r\n      };\r\n      mainButton.enable = function() {\r\n        return mainButton.setParams({is_active: true});\r\n      };\r\n      mainButton.disable = function() {\r\n        return mainButton.setParams({is_active: false});\r\n      };\r\n      mainButton.showProgress = function(leaveActive) {\r\n        isActive = !!leaveActive;\r\n        isProgressVisible = true;\r\n        updateButton();\r\n        return mainButton;\r\n      };\r\n      mainButton.hideProgress = function() {\r\n        if (!mainButton.isActive) {\r\n          isActive = true;\r\n        }\r\n        isProgressVisible = false;\r\n        updateButton();\r\n        return mainButton;\r\n      }\r\n      mainButton.setParams = setParams;\r\n      return mainButton;\r\n    })();\r\n  \r\n    var webAppInvoices = {};\r\n    function onInvoiceClosed(eventType, eventData) {\r\n      if (eventData.slug && webAppInvoices[eventData.slug]) {\r\n        var invoiceData = webAppInvoices[eventData.slug];\r\n        delete webAppInvoices[eventData.slug];\r\n        if (invoiceData.callback) {\r\n          invoiceData.callback(eventData.status);\r\n        }\r\n        receiveWebViewEvent('invoiceClosed', {\r\n          url: invoiceData.url,\r\n          status: eventData.status\r\n        });\r\n      }\r\n    }\r\n  \r\n    if (!window.Telegram) {\r\n      window.Telegram = {};\r\n    }\r\n  \r\n    Object.defineProperty(WebApp, 'initData', {\r\n      get: function(){ return webAppInitData; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'initDataUnsafe', {\r\n      get: function(){ return webAppInitDataUnsafe; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'version', {\r\n      get: function(){ return webAppVersion; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'colorScheme', {\r\n      get: function(){ return colorScheme; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'themeParams', {\r\n      get: function(){ return themeParams; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'isExpanded', {\r\n      get: function(){ return isExpanded; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'viewportHeight', {\r\n      get: function(){ return (viewportHeight === false ? window.innerHeight : viewportHeight) - mainButtonHeight; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'viewportStableHeight', {\r\n      get: function(){ return (viewportStableHeight === false ? window.innerHeight : viewportStableHeight) - mainButtonHeight; },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(WebApp, 'MainButton', {\r\n      value: MainButton,\r\n      enumerable: true\r\n    });\r\n    WebApp.isVersionAtLeast = function(ver) {\r\n      return versionAtLeast(ver);\r\n    };\r\n    WebApp.onEvent = function(eventType, callback) {\r\n      onWebViewEvent(eventType, callback);\r\n    };\r\n    WebApp.offEvent = function(eventType, callback) {offWebViewEvent(eventType, callback);\r\n    };\r\n    WebApp.sendData = function (data) {\r\n      if (!data || !data.length) {\r\n        console.error('[Telegram.WebApp] Data is required', data);\r\n        throw Error('WebAppDataInvalid');\r\n      }\r\n      if (byteLength(data) > 4096) {\r\n        console.error('[Telegram.WebApp] Data is too long', data);\r\n        throw Error('WebAppDataInvalid');\r\n      }\r\n      WebView.postEvent('web_app_data_send', false, {data: data});\r\n    };\r\n    WebApp.openTelegramLink = function (url) {\r\n      var a = document.createElement('A');\r\n      a.href = url;\r\n      if (a.protocol != 'http:' &&\r\n          a.protocol != 'https:') {\r\n        console.error('[Telegram.WebApp] Url protocol is not supported', url);\r\n        throw Error('WebAppTgUrlInvalid');\r\n      }\r\n      if (a.hostname != 't.me') {\r\n        console.error('[Telegram.WebApp] Url host is not supported', url);\r\n        throw Error('WebAppTgUrlInvalid');\r\n      }\r\n      var path_full = a.pathname + a.search;\r\n      if (isIframe || versionAtLeast('1.1')) {\r\n        WebView.postEvent('web_app_open_tg_link', false, {path_full: path_full});\r\n      } else {\r\n        location.href = 'https://t.me' + path_full;\r\n      }\r\n    };\r\n    WebApp.openInvoice = function (url, callback) {\r\n      var a = document.createElement('A'), match, slug;\r\n      a.href = url;\r\n      if (a.protocol != 'http:' &&\r\n          a.protocol != 'https:' ||\r\n          a.hostname != 't.me' ||\r\n          !(match = a.pathname.match(/^\\/(\\$|invoice\\/)([A-Za-z0-9\\-_=]+)$/)) ||\r\n          !(slug = match[2])) {\r\n        console.error('[Telegram.WebApp] Invoice url is invalid', url);\r\n        throw Error('WebAppInvoiceUrlInvalid');\r\n      }\r\n      if (!versionAtLeast('1.1')) {\r\n        console.error('[Telegram.WebApp] Method openInvoice is not supported in version ' + webAppVersion);\r\n        throw Error('WebAppMethodUnsupported');\r\n      }\r\n      if (webAppInvoices[slug]) {\r\n        console.error('[Telegram.WebApp] Invoice is already opened');\r\n        throw Error('WebAppInvoiceOpened');\r\n      }\r\n      webAppInvoices[slug] = {\r\n        url: url,\r\n        callback: callback\r\n      };\r\n      WebView.postEvent('web_app_open_invoice', false, {slug: slug});\r\n    };\r\n    WebApp.ready = function () {\r\n      WebView.postEvent('web_app_ready');\r\n    };\r\n    WebApp.expand = function () {\r\n      WebView.postEvent('web_app_expand');\r\n    };\r\n    WebApp.close = function () {\r\n      WebView.postEvent('web_app_close');\r\n    };\r\n  \r\n    window.Telegram.WebApp = WebApp;\r\n  \r\n    setViewportHeight();\r\n  \r\n    window.addEventListener('resize', onWindowResize);\r\n    if (isIframe) {\r\n      document.addEventListener('click', linkHandler);\r\n    }\r\n  \r\n    WebView.onEvent('theme_changed', onThemeChanged);\r\n    WebView.onEvent('viewport_changed', onViewportChanged);\r\n    WebView.onEvent('invoice_closed', onInvoiceClosed);\r\n    WebView.postEvent('web_app_request_theme');\r\n    WebView.postEvent('web_app_request_viewport');\r\n  \r\n  })();","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CCard',[_c('CCardHeader',[_c('strong',[_vm._v(\"Новая сделка \")])]),_c('CCardBody',[_c('CRow',[_c('CCol',{staticClass:\"form-group\",attrs:{\"sm\":\"12\"}},[_c('vue-autosuggest',{attrs:{\"suggestions\":_vm.partnerVariants,\"renderSuggestion\":_vm.renderSuggestion,\"getSuggestionValue\":_vm.getSuggestionValue,\"input-props\":{ class: ['form-control'], id: 'autosuggest__input', placeholder: 'Начните вбивать никнейм или id' }},on:{\"selected\":_vm.onSelected,\"input\":_vm.fetchResults}})],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"12\"}},[_c('CSelect',{attrs:{\"prepend\":\"Кто оплачивает комиссию?\",\"value\":_vm.feePayer,\"options\":[{ label: 'Покупатель', value: 'buyer' }, { label: 'Продавец', value: 'seller' }]},on:{\"update:value\":function($event){_vm.feePayer=$event}}})],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"12\"}},[_c('CSelect',{attrs:{\"prepend\":\"Способ оплаты\",\"value\":_vm.paymentMethodId,\"options\":_vm.paymentMethods},on:{\"update:value\":function($event){_vm.paymentMethodId=$event}}}),_c('CAlert',{staticClass:\"d-flex align-items-center\",staticStyle:{\"height\":\"10px\",\"font-size\":\"12px\"},attrs:{\"color\":\"primary\"}},[_vm._v(\" \"+_vm._s(_vm.pmString)+\" \")])],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"4\"}},[_c('CInput',{attrs:{\"type\":\"number\",\"min\":\"0\",\"prepend\":\"Сумма сделки\"},model:{value:(_vm.offerValue),callback:function ($$v) {_vm.offerValue=$$v},expression:\"offerValue\"}}),(_vm.offerValue)?_c('CAlert',{staticClass:\"d-flex align-items-center\",staticStyle:{\"height\":\"10px\",\"font-size\":\"12px\"},attrs:{\"color\":\"primary\"}},[_vm._v(\" \"+_vm._s(_vm.feeString)+\" \")]):_vm._e()],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"4\"}},[_c('CInput',{attrs:{\"type\":\"date\",\"prepend\":\"Дата доставки\"},model:{value:(_vm.estimatedShipping),callback:function ($$v) {_vm.estimatedShipping=$$v},expression:\"estimatedShipping\"}})],1),_c('CCol',{attrs:{\"sm\":\"4\"}},[_c('CInput',{attrs:{\"type\":\"date\",\"prepend\":\"Последняя дата возврата\"},model:{value:(_vm.refundDetails),callback:function ($$v) {_vm.refundDetails=$$v},expression:\"refundDetails\"}})],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"4\"}},[_c('CTextarea',{attrs:{\"label\":\"Детали\"},model:{value:(_vm.productDetails),callback:function ($$v) {_vm.productDetails=$$v},expression:\"productDetails\"}})],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"4\"}},[_c('CTextarea',{attrs:{\"label\":\"Способ передачи товара\"},model:{value:(_vm.shippingDetails),callback:function ($$v) {_vm.shippingDetails=$$v},expression:\"shippingDetails\"}})],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"4\"}},[_c('CTextarea',{attrs:{\"label\":\"Дополнительная информация\"},model:{value:(_vm.productAdditionalDetails),callback:function ($$v) {_vm.productAdditionalDetails=$$v},expression:\"productAdditionalDetails\"}})],1)],1),_c('CRow',[_c('CCol',{attrs:{\"sm\":\"4\"}},[_c('CTextarea',{attrs:{\"label\":\"Прочее\"},model:{value:(_vm.restDetails),callback:function ($$v) {_vm.restDetails=$$v},expression:\"restDetails\"}})],1)],1)],1),_c('CCardFooter',[_c('CLoadingButton',{staticStyle:{\"margin-right\":\"5px\"},attrs:{\"disabled-on-loading\":\"\",\"size\":\"sm\",\"shape\":\"square\",\"color\":\"primary\"}},[_vm._v(\" Сохранить и отправить \")]),_c('CLoadingButton',{attrs:{\"disabled-on-loading\":\"\",\"shape\":\"square\",\"size\":\"sm\",\"color\":\"danger\"},nativeOn:{\"click\":function($event){return _vm.drop()}}},[_vm._v(\" Сбросить \")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <CCard>\r\n        <CCardHeader>\r\n            <strong>Новая сделка </strong>\r\n        </CCardHeader>\r\n        <CCardBody>\r\n            <CRow>\r\n                <CCol sm=\"12\" class='form-group'>\r\n                    <vue-autosuggest :suggestions=\"partnerVariants\" :renderSuggestion=\"renderSuggestion\"\r\n                        @selected=\"onSelected\" :getSuggestionValue=\"getSuggestionValue\" @input=\"fetchResults\"\r\n                        :input-props=\"{ class: ['form-control'], id: 'autosuggest__input', placeholder: 'Начните вбивать никнейм или id' }\" />\r\n                </CCol>\r\n            </CRow>\r\n            <CRow>\r\n                <CCol sm=\"12\">\r\n                    <CSelect prepend=\"Кто оплачивает комиссию?\" :value.sync=\"feePayer\"\r\n                        :options=\"[{ label: 'Покупатель', value: 'buyer' }, { label: 'Продавец', value: 'seller' }]\" />\r\n                </CCol>\r\n            </CRow>\r\n\r\n            <CRow>\r\n                <CCol sm=\"12\">\r\n                    <CSelect prepend=\"Способ оплаты\" :value.sync=\"paymentMethodId\" :options=\"paymentMethods\" />\r\n                    <CAlert style=\"height:10px; font-size:12px;\" color=\"primary\" class=\"d-flex align-items-center\">\r\n                        {{ pmString }}\r\n                    </CAlert>\r\n                </CCol>\r\n            </CRow>\r\n            <CRow>\r\n                <CCol sm=\"4\">\r\n                    <CInput type=\"number\" min=\"0\" prepend=\"Сумма сделки\" v-model=\"offerValue\" />\r\n                    <CAlert v-if=\"offerValue\" style=\"height:10px; font-size:12px;\" color=\"primary\"\r\n                        class=\"d-flex align-items-center\">\r\n                        {{ feeString }}\r\n                    </CAlert>\r\n                </CCol>\r\n            </CRow>\r\n            <CRow>\r\n                <CCol sm=\"4\">\r\n                    <CInput type=\"date\" prepend=\"Дата доставки\" v-model=\"estimatedShipping\" />\r\n                </CCol>\r\n                <CCol sm=\"4\">\r\n                    <CInput type=\"date\" prepend=\"Последняя дата возврата\" v-model=\"refundDetails\" />\r\n                </CCol>\r\n            </CRow>\r\n            <CRow>\r\n                <CCol sm=\"4\">\r\n                    <CTextarea label=\"Детали\" v-model=\"productDetails\" />\r\n                </CCol>\r\n            </CRow>\r\n            <CRow>\r\n                <CCol sm=\"4\">\r\n                    <CTextarea label=\"Способ передачи товара\" v-model=\"shippingDetails\" />\r\n                </CCol>\r\n            </CRow>\r\n            <CRow>\r\n                <CCol sm=\"4\">\r\n                    <CTextarea label=\"Дополнительная информация\" v-model=\"productAdditionalDetails\" />\r\n                </CCol>\r\n            </CRow>\r\n            <CRow>\r\n                <CCol sm=\"4\">\r\n                    <CTextarea label=\"Прочее\" v-model=\"restDetails\" />\r\n                </CCol>\r\n            </CRow>\r\n        </CCardBody>\r\n        <CCardFooter>\r\n            <CLoadingButton disabled-on-loading size=\"sm\" shape=\"square\" color=\"primary\" style=\"margin-right:5px;\">\r\n                Сохранить и отправить\r\n            </CLoadingButton>\r\n            <CLoadingButton disabled-on-loading @click.native=\"drop()\" shape=\"square\" size=\"sm\" color=\"danger\">\r\n                Сбросить\r\n            </CLoadingButton>\r\n        </CCardFooter>\r\n    </CCard>\r\n</template>\r\n<script>\r\nimport a from '../assets/scripts/telegram-web-app.js'\r\n\r\nexport default {\r\n    name: 'WebApp',\r\n    data() {\r\n        return {\r\n            query: '',\r\n            partnerVariants: [],\r\n            feePayer: 'buyer',\r\n            offerValue: '',\r\n            paymentMethodId: '',\r\n            estimatedShipping: '',\r\n            refundDetails: '',\r\n            productDetails: '',\r\n            shippingDetails: '',\r\n            productAdditionalDetails: '',\r\n            restDetails: '',\r\n            paymentMethods: [],\r\n            partnerId: '',\r\n        }\r\n    },\r\n    created: function () {\r\n        this.$http({ method: \"GET\", url: `/v1/webapp/configs` }).then(res => {\r\n            this.paymentMethods = res.data\r\n            this.paymentMethodId = res.data[0].value\r\n        })\r\n    },\r\n    mounted: function () {\r\n        //console.log(window.Telegram.WebApp.initDataUnsafe)\r\n    },\r\n    methods: {\r\n        fetchResults: function (value) {\r\n            this.$http({ method: \"GET\", url: `/v1/webapp/user?partial=${value}` }).then(res => {\r\n                this.partnerVariants = [{ data: res.data }]\r\n            })\r\n        },\r\n        onSelected: function (selected) {\r\n            this.partnerId = selected.item.id;\r\n        },\r\n        getSuggestionValue(suggestion) {\r\n            return suggestion.item.username || suggestion.item.chatId\r\n        },\r\n        renderSuggestion(suggestion) {\r\n            return `${suggestion.item.username || suggestion.item.chatId} ${+suggestion.item.offers} сделок, ${+suggestion.item.violations} нарушений`\r\n        },\r\n        drop() {\r\n            this.feePayer = 'buyer'\r\n            this.offerValue = ''\r\n            this.paymentMethodId = this.paymentMethods[0].value\r\n            this.estimatedShipping = ''\r\n            this.refundDetails = ''\r\n            this.productDetails = ''\r\n            this.shippingDetails = ''\r\n            this.productAdditionalDetails = ''\r\n            this.restDetails = ''\r\n        },\r\n        getPmCode(pm){\r\n            return pm.label == \"Банковская карта\" || pm.label == \"QIWI\" ? 'Руб' : pm.label\r\n        }\r\n    },\r\n    computed: {\r\n        feeString() {\r\n            const paymentMethod = this.paymentMethods.find(pm => pm.value === this.paymentMethodId)\r\n            return `Размер комиссии: ${Math.max((this.offerValue * paymentMethod.feePercent) / 100, paymentMethod.feeRaw)} ${this.getPmCode(paymentMethod)}`\r\n        },\r\n        pmString() {\r\n            const pm = this.paymentMethods.find(pm => pm.value == this.paymentMethodId)\r\n            const label = this.getPmCode(pm)\r\n            return pm ? `${pm.minSum} - ${pm.maxSum} ${label}, комиссия ${pm.feeRaw} ${label} или ${pm.feePercent}%` : ''\r\n        },\r\n    }\r\n}\r\n</script>\r\n<style>\r\n#app {\r\n    font-family: \"Avenir\", Helvetica, Arial, sans-serif;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n    color: #2c3e50;\r\n    margin-top: 60px;\r\n}\r\n\r\n.avatar {\r\n    height: 25px;\r\n    width: 25px;\r\n    border-radius: 20px;\r\n    margin-right: 10px;\r\n}\r\n\r\n\r\n#autosuggest__input.autosuggest__input-open {\r\n    border-bottom-left-radius: 0;\r\n    border-bottom-right-radius: 0;\r\n}\r\n\r\n.autosuggest__results-container {\r\n    position: relative;\r\n    width: 100%;\r\n}\r\n\r\n.autosuggest__results {\r\n    font-weight: 300;\r\n    margin: 0;\r\n    position: absolute;\r\n    z-index: 10000001;\r\n    width: 100%;\r\n    border: 1px solid #e0e0e0;\r\n    border-bottom-left-radius: 4px;\r\n    border-bottom-right-radius: 4px;\r\n    background: white;\r\n    padding: 0px;\r\n    max-height: 400px;\r\n    overflow-y: scroll;\r\n}\r\n\r\n.autosuggest__results ul {\r\n    list-style: none;\r\n    padding-left: 0;\r\n    margin: 0;\r\n}\r\n\r\n.autosuggest__results .autosuggest__results-item {\r\n    cursor: pointer;\r\n    padding: 15px;\r\n}\r\n\r\n#autosuggest ul:nth-child(1)>.autosuggest__results_title {\r\n    border-top: none;\r\n}\r\n\r\n.autosuggest__results .autosuggest__results-before {\r\n    color: gray;\r\n    font-size: 11px;\r\n    margin-left: 0;\r\n    padding: 15px 13px 5px;\r\n    border-top: 1px solid lightgray;\r\n}\r\n\r\n.autosuggest__results .autosuggest__results-item:active,\r\n.autosuggest__results .autosuggest__results-item:hover,\r\n.autosuggest__results .autosuggest__results-item:focus,\r\n.autosuggest__results .autosuggest__results-item.autosuggest__results-item--highlighted {\r\n    background-color: #f6f6f6;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WebApp.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WebApp.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./WebApp.vue?vue&type=template&id=5b21db68&\"\nimport script from \"./WebApp.vue?vue&type=script&lang=js&\"\nexport * from \"./WebApp.vue?vue&type=script&lang=js&\"\nimport style0 from \"./WebApp.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WebApp.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}