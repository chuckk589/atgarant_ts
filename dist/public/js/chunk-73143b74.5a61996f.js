(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73143b74"],{"21a6":function(t,e,a){(function(a){var o,n,r;(function(a,i){n=[],o=i,r="function"===typeof o?o.apply(e,n):o,void 0===r||(t.exports=r)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function o(t,e,a){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){s(o.response,e,a)},o.onerror=function(){console.error("could not download file")},o.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(o){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(t,e,a){var l=i.URL||i.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener","string"==typeof t?(s.href=t,s.origin===location.origin?r(s):n(s.href)?o(t,e,a):r(s,s.target="_blank")):(s.href=l.createObjectURL(t),setTimeout((function(){l.revokeObjectURL(s.href)}),4e4),setTimeout((function(){r(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,a,i){if(a=a||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,i),a);else if(n(t))o(t,a,i);else{var l=document.createElement("a");l.href=t,l.target="_blank",setTimeout((function(){r(l)}))}}:function(t,e,a,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return o(t,e,a);var r="application/octet-stream"===t.type,s=/constructor/i.test(i.HTMLElement)||i.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||r&&s||l)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},c.readAsDataURL(t)}else{var d=i.URL||i.webkitURL,f=d.createObjectURL(t);n?n.location=f:location.href=f,n=null,setTimeout((function(){d.revokeObjectURL(f)}),4e4)}});i.saveAs=s.saveAs=s,t.exports=s}))}).call(this,a("c8ba"))},2713:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("CExtendedModal",{attrs:{vis:t.modalConfig.show,mData:t.modalConfig.data},on:{"modal-closed":function(e){return t.closeModalHandler()}},scopedSlots:t._u([{key:"slider",fn:function(){return[a("CInputCheckbox",{attrs:{checked:t.modalConfig.custom.customPayout,label:"Распределить выплату"},on:{click:t.handleSidesWallets,"update:checked":function(e){return t.$set(t.modalConfig.custom,"customPayout",e)}}}),a("CCollapse",{attrs:{show:t.modalConfig.custom.customPayout}},[a("CInput",{staticClass:"range",attrs:{label:"Покупатель "+t.modalConfig.custom.sliderValBuyer+"%",type:"range",min:"0",max:"100",value:t.modalConfig.custom.sliderValBuyer},on:{"update:value":function(e){return t.$set(t.modalConfig.custom,"sliderValBuyer",e)},input:function(e){return t.rangeI(e,0)}}}),a("CInput",{staticClass:"range",attrs:{label:"Продавец "+t.modalConfig.custom.sliderValSeller+"%",type:"range",min:"0",max:"100",value:t.modalConfig.custom.sliderValSeller},on:{"update:value":function(e){return t.$set(t.modalConfig.custom,"sliderValSeller",e)},input:function(e){return t.rangeI(e,1)}}})],1)]},proxy:!0}])}),a("CDataTable",{attrs:{items:t.arbs,fields:t.fields,sorter:"",columnFilter:""},scopedSlots:t._u([{key:"offer",fn:function(e){var o=e.item;return[a("td",{attrs:{"data-label":"ID сделки"}},[t._v(" "+t._s(o.offer.id)+" ")])]}},{key:"arbiter",fn:function(e){var o=e.item;return[a("td",{attrs:{"data-label":"Арбитр"}},[t._v(" "+t._s(o.arbiter.username||o.arbiter.chat_id)+" ")])]}},{key:"initiator",fn:function(e){var o=e.item;return[a("td",{attrs:{"data-label":"Инициатор арбитража"}},[t._v(" "+t._s(o.initiator.username||o.initiator.chat_id)+" ")])]}},{key:"status",fn:function(e){var o=e.item;return[a("td",{attrs:{"data-label":"Статус арбитража"}},[t._v(" "+t._s(t.getStatus(o.status))+" ")])]}},{key:"createdAt",fn:function(e){var o=e.item;return[a("td",{attrs:{"data-label":"Дата создания"}},[t._v(" "+t._s(new Date(o.createdAt).toLocaleString())+" ")])]}},{key:"action",fn:function(e){var o=e.item;return[a("td",[a("CDropdown",{staticClass:"m-2",attrs:{"toggler-text":"Действия",color:"secondary"}},[a("CDropdownItem",{directives:[{name:"show",rawName:"v-show",value:t.isArb,expression:"isArb"}],attrs:{disabled:t.isActive(o)},on:{click:function(e){return t.closeArb(o)}}},[t._v("Вынести решение")]),a("CDropdownItem",{directives:[{name:"show",rawName:"v-show",value:!t.isArb,expression:"!isArb"}],attrs:{disabled:t.isDisputed(o)},on:{click:function(e){return t.openDispute(o)}}},[t._v("Обжаловать")]),a("CDropdownItem",{on:{click:function(e){return t.getChatHistory(o)}}},[t._v("История чата")])],1)],1)]}}])})],1)},n=[],r=a("7a07"),i=a("d35b");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function s(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){u(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var c=a("21a6"),d={name:"Arbitrary",components:{CExtendedModal:r["a"]},mixins:[i["a"]],data:function(){return{modalConfig:{show:!1,custom:{customPayout:!1,sliderValBuyer:0,sliderValSeller:100},data:{}},arbs:[],fields:[{key:"status",label:"Статус арбитража"},{key:"offer",label:"ID сделки"},{key:"chatId",label:"ID чата арбитража"},{key:"reason",label:"Причина обращения"},{key:"buyerPayout",label:"Выплата продавцу %"},{key:"sellerPayout",label:"Выплата покупателю %"},{key:"arbiter",label:"Арбитр"},{key:"initiator",label:"Инициатор арбитража"},{key:"createdAt",label:"Дата создания"},{key:"comment",label:"Решение арбитра"},{key:"action",label:"",filter:!1,sorter:!1}]}},mounted:function(){var t=this;this.$http({method:"GET",url:"/v1/arbitrary".concat(1===this.userData.role||2===this.userData.role?"/":"?userId=".concat(this.userData.id))}).then((function(e){t.arbs=e.data}))},methods:{getStatus:function(t){return"closed"==t?"Предварительное решение":"active"==t?"В процессе":"disputed"==t?"Оспаривается":"closedF"==t?"Окончательное решение":void 0},rangeI:function(t,e){0===e?this.modalConfig.custom.sliderValSeller=100-+t:this.modalConfig.custom.sliderValBuyer=100-+t},isActive:function(t){return!("active"==t.status||"disputed"==t.status)},isDisputed:function(t){return!("closed"==t.status&&(new Date-new Date(t.updatedAt))/36e5<=12)},closeArb:function(t){this.modalConfig.data={cur:t,fields:[{label:"Комментарий",value:t.comment},{label:"slider"}],footer:"Сохранить",header:"Арбитраж",type:"closeArbitrary"},this.modalConfig.show=!0},handleSidesWallets:function(t){this.modalConfig.data.cur.offer.sellerWalletData&&this.modalConfig.data.cur.offer.buyerWalletData||(t.preventDefault(),alert("Для разрешения арбитража с распределением выплат требуется чтобы у обоих сторон сделки был указан кошелек для выплат"))},closeModalHandler:function(){var t=this;if("closeArbitrary"==this.modalConfig.data.type){var e=this.modalConfig.data.fields.find((function(t){return"Комментарий"==t.label})).value,a=this.modalConfig.custom.customPayout?{buyerPayout:+this.modalConfig.custom.sliderValSeller,sellerPayout:+this.modalConfig.custom.sliderValBuyer}:{};this.$http({method:"POST",url:"/v1/arbitrary/".concat(this.modalConfig.data.cur.id,"/close/"),data:s({comment:e},a)}).then((function(a){t.modalConfig.data.cur.status=a.data.newStatus,t.modalConfig.data.cur.comment=e}))}},getChatHistory:function(t){this.$http({method:"GET",url:"/v1/arbitrary/".concat(t.id,"/history/")}).then((function(e){var a=new Blob([e.data],{type:"text/plain;charset=utf-8"});c.saveAs(a,"".concat(t.id,"_").concat((new Date).toLocaleDateString(),".txt"))}))},openDispute:function(t){this.$http({method:"POST",url:"/v1/arbitrary/".concat(t.id,"/dispute/"),data:{initiator:this.userData.id}}).then((function(e){t.status=e.data.newStatus}))}}},f=d,m=(a("a50c"),a("2877")),p=Object(m["a"])(f,o,n,!1,null,null,null);e["default"]=p.exports},"7a07":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CModal",{attrs:{show:t.vis,title:t.mData.header},on:{"update:show":function(e){t.vis=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[t.disableFooter?a("p"):a("CButton",{attrs:{color:"primary"},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.mData.footer))])]},proxy:!0}])},[t._t("content"),t._l(t.mData.fields,(function(e,o){return[t.$scopedSlots[e.label]?[t._t(e.label,null,{item:e})]:e.select?a("CSelect",{key:o,attrs:{label:e.label,value:e.value,options:e.select},on:{"update:value":function(a){return t.$set(e,"value",a)}}}):a("CInput",{key:o,attrs:{label:e.label},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"field.value"}})]}))],2)},n=[],r={name:"ExtendedModal",data:function(){return{}},props:{vis:Boolean,disableFooter:Boolean,mData:Object},methods:{closeModal:function(){this.$emit("modal-closed"),this.vis=!1}}},i=r,l=a("2877"),s=Object(l["a"])(i,o,n,!1,null,null,null);e["a"]=s.exports},a50c:function(t,e,a){"use strict";a("ec9a")},ec9a:function(t,e,a){}}]);
//# sourceMappingURL=chunk-73143b74.5a61996f.js.map