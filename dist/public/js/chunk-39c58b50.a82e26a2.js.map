{"version":3,"sources":["webpack:///./vue/views/Users.vue?4697","webpack:///vue/views/Users.vue","webpack:///./vue/views/Users.vue?dc45","webpack:///./vue/views/Users.vue","webpack:///./vue/containers/CExtendedModal.vue?acbb","webpack:///vue/containers/CExtendedModal.vue","webpack:///./vue/containers/CExtendedModal.vue?0033","webpack:///./vue/containers/CExtendedModal.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","modalConfig","show","data","on","$event","closeModalHandler","scopedSlots","_u","key","fn","ref","item","roles","value","$set","users","fields","_v","_s","find","f","role","label","Date","createdAt","toLocaleString","staticClass","setRole","addLink","_e","addViolation","staticRenderFns","name","components","CExtendedModal","mixins","cur","filter","sorter","mounted","$http","method","url","methods","user","footer","header","type","then","userId","text","component","vis","mData","closeModal","proxy","_t","_l","field","index","$scopedSlots","select","model","callback","$$v","expression","props","disableFooter","$emit"],"mappings":"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","file":"js/chunk-39c58b50.a82e26a2.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('CExtendedModal',{attrs:{\"vis\":_vm.modalConfig.show,\"mData\":_vm.modalConfig.data},on:{\"modal-closed\":function($event){return _vm.closeModalHandler()}},scopedSlots:_vm._u([{key:\"role\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('CSelect',{attrs:{\"label\":\"Роль\",\"options\":_vm.roles,\"value\":item.value},on:{\"update:value\":function($event){return _vm.$set(item, \"value\", $event)}}})]}}])}),_c('CDataTable',{attrs:{\"items\":_vm.users,\"fields\":_vm.fields,\"sorter\":\"\",\"columnFilter\":\"\"},scopedSlots:_vm._u([{key:\"role\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_vm._v(_vm._s(_vm.roles.find(function (f){ return f.value === item.role; }).label))])]}},{key:\"createdAt\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_vm._v(_vm._s(new Date(item.createdAt).toLocaleString()))])]}},{key:\"action\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_c('CDropdown',{staticClass:\"m-2\",attrs:{\"toggler-text\":\"Действия\",\"color\":\"secondary\"}},[_c('CDropdownItem',{on:{\"click\":function($event){return _vm.setRole(item)}}},[_vm._v(\"Изменить роль\")]),(_vm.isAdmin)?_c('CDropdownItem',{on:{\"click\":function($event){return _vm.addLink(item)}}},[_vm._v(\"Добавить ссылку\")]):_vm._e(),(_vm.isAdmin)?_c('CDropdownItem',{on:{\"click\":function($event){return _vm.addViolation(item)}}},[_vm._v(\"Добавить нарушение\")]):_vm._e()],1)],1)]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <CExtendedModal @modal-closed = \"closeModalHandler()\" :vis=\"modalConfig.show\" :mData=\"modalConfig.data\">\r\n      <template #role=\"{item}\">\r\n        <CSelect label=\"Роль\" :options=\"roles\" :value.sync=\"item.value\"/>\r\n      </template>\r\n    </CExtendedModal>\r\n    <CDataTable\r\n    :items=\"users\"\r\n    :fields=\"fields\"\r\n    sorter\r\n    columnFilter>\r\n    <template #role=\"{item}\"><td>{{roles.find(f=>f.value === item.role).label}}</td></template>\r\n    <template #createdAt=\"{item}\"><td>{{new Date(item.createdAt).toLocaleString()}}</td></template>\r\n    <!-- <template #initiator=\"{item}\"><td data-label = \"Инициатор сделки\">{{item.initiator.username || item.initiator.chat_id}}</td></template>\r\n    <template #offerStatus=\"{item}\"><td data-label = \"Статус сделки\">{{item.offerStatus.name}}</td></template>\r\n    <template #partner=\"{item}\"><td data-label = \"Компаньон\">{{item.partner.username || item.partner.chat_id}}</td></template>\r\n    <template #paymentMethod=\"{item}\"><td data-label = \"Способ оплаты\">{{item.paymentMethod.name}}</td></template>\r\n    <template #createdAt=\"{item}\"><td data-label = \"Дата создания\">{{new Date(item.createdAt).toLocaleString()}}</td></template>\r\n    <template #role=\"{item}\"><td data-label = \"Роль инициатора\">{{item.role === 'seller'?'Продавец':'Покупатель'}}</td></template> -->\r\n    <template #action=\"{item}\">\r\n      <td>\r\n        <CDropdown toggler-text=\"Действия\" class=\"m-2\" color=\"secondary\">\r\n          <CDropdownItem @click=\"setRole(item)\">Изменить роль</CDropdownItem>\r\n          <CDropdownItem @click=\"addLink(item)\" v-if=\"isAdmin\">Добавить ссылку</CDropdownItem>\r\n          <CDropdownItem @click=\"addViolation(item)\" v-if=\"isAdmin\">Добавить нарушение</CDropdownItem>\r\n          <!-- <CDropdownItem @click=\"deleteUser(item)\">Удалить пользователя</CDropdownItem> -->\r\n        </CDropdown>\r\n      </td>\r\n    </template>\r\n    </CDataTable>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CExtendedModal from '../containers/CExtendedModal.vue'\r\nimport mixin from '../mixins/userData'\r\nexport default {\r\n  name: 'Users',\r\n  components: {\r\n    CExtendedModal\r\n  },\r\n  mixins: [mixin],\r\n  data () {\r\n    return {\r\n      modalConfig:{\r\n        show:false,\r\n        data:{},\r\n        cur:{}\r\n      },\r\n      roles:[{ \r\n          value: 0, \r\n          label: 'Пользователь'\r\n        },{ \r\n          value: 1, \r\n          label: 'Администратор'\r\n        },{ \r\n          value: 2, \r\n          label: 'Арбитр'\r\n        }],\r\n      users:[],\r\n      fields:[\r\n        {key:'id', label:'Id'},\r\n        {key:'role', label:'Роль'},\r\n        {key:'chat_id', label:'Telegram Id'},\r\n        {key:'username', label:'Имя пользователя'},\r\n        {key:'first_name', label:'Имя'},\r\n        {key:'locale', label:'Язык'},\r\n        {key:'createdAt', label:'Дата регистрации'},\r\n        {key:'action', label: '', filter: false,sorter: false}\r\n      ]\r\n    }\r\n  },\t\t\r\n  mounted:function() {\r\n    this.$http({method: 'GET', url: `/v1/user/`}).then(e => {\r\n      this.users = e.data\r\n    })\r\n  },\r\n  methods:{\r\n    setRole(user){\r\n      this.modalConfig.data = {\r\n        cur:user,\r\n        fields:[{label:'role', value: user.role}],\r\n        footer:'Сохранить',\r\n        header: 'Задать роль',\r\n        type:'role'\r\n      }\r\n      this.modalConfig.show = true\r\n    },\r\n    addViolation(user){\r\n      this.modalConfig.data = {\r\n        cur: user,\r\n        fields:[{label:'Комментарий', value: ''}],\r\n        footer:'Сохранить',\r\n        header: 'Добавить нарушение',\r\n        type:'violation'\r\n      }\r\n      this.modalConfig.show = true\r\n    },\r\n    addLink(user){\r\n      this.modalConfig.data = {\r\n        cur: user,\r\n        fields:[{label:'Ссылка на ресурс пользователя', value: ''}],\r\n        footer:'Сохранить',\r\n        header: 'Верифицировать пользователя',\r\n        type:'link'\r\n      }\r\n      this.modalConfig.show = true\r\n    },\r\n    closeModalHandler(){\r\n      if(this.modalConfig.data.type == 'role'){\r\n        const newRole = this.modalConfig.data.fields.find(f=>f.label == 'role').value\r\n        this.$http({method: 'PUT', url: `/v1/user/${this.modalConfig.data.cur.id}/`, data:{role:newRole}})\r\n        .then(res=>{\r\n          this.modalConfig.data.cur.role = newRole\r\n        })\r\n      }else if(this.modalConfig.data.type == 'link'){\r\n        const userId = this.modalConfig.data.cur.id\r\n        const url = this.modalConfig.data.fields[0].value\r\n        this.$http({method: 'POST', url: `/v1/link/`, data:{\r\n          userId: userId,\r\n          url:url\r\n          }\r\n        })\r\n      }else if(this.modalConfig.data.type == 'violation'){\r\n        const userId = this.modalConfig.data.cur.id\r\n        const text = this.modalConfig.data.fields[0].value\r\n        this.$http({method: 'POST', url: `/v1/violation/`, data:{\r\n          userId: userId,\r\n          text: text\r\n          }\r\n        })\r\n      }\r\n    },\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Users.vue?vue&type=template&id=0ab83699&\"\nimport script from \"./Users.vue?vue&type=script&lang=js&\"\nexport * from \"./Users.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CModal',{attrs:{\"show\":_vm.vis,\"title\":_vm.mData.header},on:{\"update:show\":function($event){_vm.vis=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [(_vm.disableFooter)?_c('p'):_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.closeModal()}}},[_vm._v(_vm._s(_vm.mData.footer))])]},proxy:true}])},[_vm._t(\"content\"),_vm._l((_vm.mData.fields),function(field,index){return [(_vm.$scopedSlots[field.label])?[_vm._t(field.label,null,{\"item\":field})]:(field.select)?_c('CSelect',{key:index,attrs:{\"label\":field.label,\"value\":field.value,\"options\":field.select},on:{\"update:value\":function($event){return _vm.$set(field, \"value\", $event)}}}):_c('CInput',{key:index,attrs:{\"label\":field.label},model:{value:(field.value),callback:function ($$v) {_vm.$set(field, \"value\", $$v)},expression:\"field.value\"}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <CModal :show.sync = \"vis\" :title =\"mData.header\">\r\n    <slot name = \"content\"></slot>\r\n    <template v-for=\"(field,index) in mData.fields\">\r\n      <template v-if=\"$scopedSlots[field.label]\">\r\n        <slot :name=\"field.label\" :item=\"field\" />\r\n      </template>\r\n      <CSelect v-else-if=\"field.select\" :label=\"field.label\" :value.sync=\"field.value\" :options=\"field.select\" :key=\"index\"/>\r\n      <CInput v-else :label=\"field.label\" v-model=\"field.value\" :key=\"index\"/>\r\n    </template>\r\n    <template #footer>\r\n      <p v-if=\"disableFooter\"></p>\r\n      <CButton v-else color=\"primary\" @click=\"closeModal()\">{{mData.footer}}</CButton>\r\n    </template>\r\n  </CModal>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'ExtendedModal',\r\n  \r\n  data () {\r\n    return {\r\n    }\r\n  },\r\n  props: {\r\n    vis: Boolean,\r\n    disableFooter:Boolean,\r\n    mData: Object\r\n    // {\r\n    //   fields:[{label:'22',value:22}],\r\n    //   footer:'test',\r\n    //   header:'testHeader'\r\n    // }\r\n  },\r\n  methods:{\r\n    closeModal(){\r\n      this.$emit('modal-closed')\r\n      this.vis = false\r\n    }\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CExtendedModal.vue?vue&type=template&id=fbe6e38a&\"\nimport script from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}